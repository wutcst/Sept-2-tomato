{"version":3,"file":"js/786.06d98284.js","mappings":"0JAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,KAAK,CAACF,EAAIK,GAAG,QAAQL,EAAIM,GAAGN,EAAIO,YAAYL,EAAG,UAAU,CAACM,IAAI,OAAOJ,YAAY,gBAAgBK,MAAM,CAAC,MAAQT,EAAIU,KAAK,cAAc,SAAS,CAACR,EAAG,eAAe,CAACO,MAAM,CAAC,MAAQ,KAAK,KAAO,WAAW,CAACP,EAAG,WAAW,CAACO,MAAM,CAAC,YAAc,SAASE,MAAM,CAACC,MAAOZ,EAAIU,KAAKG,OAAQC,SAAS,SAAUC,GAAMf,EAAIgB,KAAKhB,EAAIU,KAAM,SAAUV,EAAIiB,GAAGF,GAAK,EAAEG,WAAW,kBAAkB,GAAGhB,EAAG,eAAe,CAACO,MAAM,CAAC,MAAQ,OAAO,CAACP,EAAG,YAAY,CAACO,MAAM,CAAC,KAAO,WAAWU,GAAG,CAAC,MAAQnB,EAAIoB,UAAU,CAACpB,EAAIK,GAAG,QAAQH,EAAG,YAAY,CAACO,MAAM,CAAC,KAAO,UAAUU,GAAG,CAAC,MAAQnB,EAAIqB,UAAU,CAACrB,EAAIK,GAAG,SAAS,IAAI,IAAI,EAChsB,EACIiB,EAAkB,G,UCetB,GACAC,IAAAA,GACA,OACAhB,QAAA,EACAG,KAAA,CACAG,OAAA,MAGA,EACAW,OAAAA,GAEA,KAAAC,cACA,EACAC,QAAA,CACAD,YAAAA,GAGA,MAAAE,EAAAC,aAAAC,QAAA,UACAC,EAAAA,EAAAC,IAAA,8BAAAJ,KACAK,MAAAC,IAEA,YAAAC,GAAAD,EAAAV,KAAAA,KACA,KAAAhB,QAAA2B,CAAA,IAEAC,OAAAC,IACAC,QAAAD,MAAA,4BAAAA,EAAA,GAEA,EACAhB,OAAAA,GAEA,KAAAkB,cAAA,UACA,EACAjB,OAAAA,GAEA,KAAAiB,cAAA,UACA,EACAA,aAAAA,CAAAC,GACA,MAAA1B,EAAA2B,WAAA,KAAA9B,KAAAG,QACA,IAAA4B,MAAA5B,IAAAA,EAAA,GAGA,MAAAc,EAAAC,aAAAC,QAAA,UACAC,EAAAA,EAAAY,IAAA,uCAAAf,IAAA,CACAd,OAAAA,EACA0B,OAAAA,IAEAP,MAAAC,IAEA,MAAAU,EAAAV,EAAAV,KACA,KAAAqB,YACA,YAAAL,EACA,KAAAM,SAAAC,QAAA,QACA,SAAAH,EACA,KAAAE,SAAAT,MAAA,SAGA,KAAAS,SAAAC,QAAA,QAEA,KAAArB,cAAA,IAEAU,OAAAC,IACAC,QAAAD,MAAA,0BAAAA,GACA,KAAAS,SAAAT,MAAA,cAEA,MACA,KAAAS,SAAAT,MAAA,WAEA,EACAQ,SAAAA,GACA,KAAAG,MAAArC,KAAAsC,aACA,ICvF4Q,I,UCQxQC,GAAY,OACd,EACAlD,EACAuB,GACA,EACA,KACA,WACA,MAIF,EAAe2B,EAAiB,O","sources":["webpack://webwork/./src/views/home/index2/moneyManage.vue","webpack://webwork/src/views/home/index2/moneyManage.vue","webpack://webwork/./src/views/home/index2/moneyManage.vue?5d6f","webpack://webwork/./src/views/home/index2/moneyManage.vue?2c74"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"money-manage\"},[_c('h1',[_vm._v(\"我的余额：\"+_vm._s(_vm.balance))]),_c('el-form',{ref:\"form\",staticClass:\"demo-ruleForm\",attrs:{\"model\":_vm.form,\"label-width\":\"80px\"}},[_c('el-form-item',{attrs:{\"label\":\"金额\",\"prop\":\"amount\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入金额\"},model:{value:(_vm.form.amount),callback:function ($$v) {_vm.$set(_vm.form, \"amount\", _vm._n($$v))},expression:\"form.amount\"}})],1),_c('el-form-item',{attrs:{\"label\":\"操作\"}},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.deposit}},[_vm._v(\"充值\")]),_c('el-button',{attrs:{\"type\":\"danger\"},on:{\"click\":_vm.consume}},[_vm._v(\"消费\")])],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"money-manage\">\r\n        <h1>我的余额：{{ balance }}</h1>\r\n        <el-form :model=\"form\" ref=\"form\" label-width=\"80px\" class=\"demo-ruleForm\">\r\n            <el-form-item label=\"金额\" prop=\"amount\">\r\n                <el-input v-model.number=\"form.amount\" placeholder=\"请输入金额\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"操作\">\r\n                <el-button type=\"primary\" @click=\"deposit\">充值</el-button>\r\n                <el-button type=\"danger\" @click=\"consume\">消费</el-button>\r\n            </el-form-item>\r\n        </el-form>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import axios from 'axios';\r\n    export default {\r\n        data() {\r\n            return {\r\n                balance: 0, // 初始余额，页面加载时从后端获取\r\n                form: {\r\n                    amount: null // 充值或消费的金额\r\n                }\r\n            };\r\n        },\r\n        mounted() {\r\n            // 页面加载时从后端获取初始余额\r\n            this.fetchBalance();\r\n        },\r\n        methods: {\r\n            fetchBalance() {\r\n                // 发送HTTP请求到后端获取用户数据\r\n                // 假设您的后端接口地址是 http://localhost:8080/user/{userId}，并且userId存储在localStorage中\r\n                const userId = localStorage.getItem('userId'); // 假设userId是用户的id\r\n                axios.get(`http://localhost:8080/user/${userId}`)\r\n                    .then(response => {\r\n                        // 获取到用户数据后解构并更新userData对象\r\n                        const { money } = response.data.data;\r\n                        this.balance = money;\r\n                    })\r\n                    .catch(error => {\r\n                        console.error('Error fetching user data:', error);\r\n                    });\r\n            },\r\n            deposit() {\r\n                // 发送充值请求给后端\r\n                this.updateBalance('deposit');\r\n            },\r\n            consume() {\r\n                // 发送消费请求给后端\r\n                this.updateBalance('consume');\r\n            },\r\n            updateBalance(action) {\r\n                const amount = parseFloat(this.form.amount);\r\n                if (!isNaN(amount) && amount > 0) {\r\n\r\n                    // 发送请求给后端，假设后端接口地址为 '/api/updateBalance'\r\n                    const userId = localStorage.getItem('userId'); // 假设userId是用户的id\r\n                    axios.put(`http://localhost:8080/updateBalance/${userId}`, {\r\n                        amount: amount,\r\n                        action: action\r\n                    })\r\n                        .then(response => {\r\n                            // 根据后端返回的数据更新前端余额数据\r\n                            const msg = response.data;\r\n                            this.resetForm();\r\n                            if (action === 'deposit') {\r\n                                this.$message.success('充值成功');\r\n                            } else if (msg === '余额不足') {\r\n                                this.$message.error('余额不足！');\r\n                            }\r\n                            else {\r\n                                this.$message.success('消费成功');\r\n                            }\r\n                            this.fetchBalance();\r\n                        })\r\n                        .catch(error => {\r\n                            console.error('Error updating balance:', error);\r\n                            this.$message.error('操作失败，请重试');\r\n                        });\r\n                } else {\r\n                    this.$message.error('请输入有效的金额');\r\n                }\r\n            },\r\n            resetForm() {\r\n                this.$refs.form.resetFields(); // 重置表单\r\n            }\r\n        }\r\n    };\r\n</script>\r\n\r\n<style scoped>\r\n    .money-manage {\r\n        margin: 20px;\r\n        height: 200px;\r\n        border-radius: 10px;\r\n        background-color: aliceblue;\r\n    }\r\n\r\n    h1{\r\n        text-align: center;\r\n        padding-top: 10px;\r\n    }\r\n    .demo-ruleForm {\r\n        max-width: 400px;\r\n        margin: 0 auto;\r\n    }\r\n</style>","import mod from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./moneyManage.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./moneyManage.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./moneyManage.vue?vue&type=template&id=c99837bc&scoped=true\"\nimport script from \"./moneyManage.vue?vue&type=script&lang=js\"\nexport * from \"./moneyManage.vue?vue&type=script&lang=js\"\nimport style0 from \"./moneyManage.vue?vue&type=style&index=0&id=c99837bc&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"c99837bc\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","_v","_s","balance","ref","attrs","form","model","value","amount","callback","$$v","$set","_n","expression","on","deposit","consume","staticRenderFns","data","mounted","fetchBalance","methods","userId","localStorage","getItem","axios","get","then","response","money","catch","error","console","updateBalance","action","parseFloat","isNaN","put","msg","resetForm","$message","success","$refs","resetFields","component"],"sourceRoot":""}