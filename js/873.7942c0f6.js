"use strict";(self["webpackChunkwebwork"]=self["webpackChunkwebwork"]||[]).push([[873],{36857:(e,t,o)=>{o.r(t),o.d(t,{default:()=>H});var a=function(){var e=this,t=e._self._c;return t("el-container",{staticClass:"home-container"},[t("el-container",[t("el-main",{staticClass:"main-content"},[t("main-content",{attrs:{currentRoomId:e.currentRoomId}}),t("div",{staticClass:"main-chat"},[t("main-chat")],1),t("div",{staticClass:"button-container"},[t("el-button",{staticClass:"exit",on:{click:function(t){e.showExitDialog=!0}}},[e._v("é€€å‡ºæ¸¸æˆ")]),t("el-button",{staticClass:"back",on:{click:function(t){return e.move("back")}}},[e._v("è¿”å›")])],1),t("div",{staticClass:"dialog-container"},[t("div",{staticClass:"dialog"},[t("div",{staticClass:"dialog-content"},[t("img",{attrs:{width:"100px",src:o(81810),alt:""}}),t("div",{staticClass:"text-display"},[t("p",[e._v(e._s(e.displayedText))])])]),t("div",{staticClass:"controls"},[t("div",{staticClass:"row"},[t("el-button",{staticClass:"north",on:{click:function(t){return e.move("north")}}},[e._v("åŒ—")])],1),t("div",{staticClass:"row"},[t("el-button",{staticClass:"west",on:{click:function(t){return e.move("west")}}},[e._v("è¥¿")]),t("el-button",{staticClass:"stay",on:{click:function(t){return e.move("stay")}}},[e._v("S")]),t("el-button",{staticClass:"east",on:{click:function(t){return e.move("east")}}},[e._v("ä¸œ")])],1),t("div",{staticClass:"row"},[t("el-button",{staticClass:"south",on:{click:function(t){return e.move("south")}}},[e._v("å—")])],1)])])])],1),t("el-aside",{staticClass:"sidebar-container",attrs:{width:"300px"}},[t("app-sidebar"),t("img",{attrs:{src:o(26263),alt:""}}),t("h2",{staticClass:"location"},[t("span",[e._v(e._s(e.locationMap[e.currentRoomId]))])])],1)],1),t("el-dialog",{attrs:{title:"ç¡®è®¤é€€å‡º",visible:e.showExitDialog,width:"30%"},on:{"update:visible":function(t){e.showExitDialog=t},close:function(t){e.showExitDialog=!1}}},[t("span",[e._v("æ‚¨ç¡®å®šè¦é€€å‡ºæ¸¸æˆå—ï¼Ÿ")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.showExitDialog=!1}}},[e._v("å–æ¶ˆ")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirmExit}},[e._v("ç¡®è®¤")])],1)])],1)},n=[],i=o(47546),s=o(24634),c=(o(52675),o(89463),o(28706),o(44114),o(76031),o(62010),function(){var e=this,t=e._self._c;return t("div",{staticClass:"main-content",style:{backgroundImage:"url(".concat(e.currentLocation.backgroundImage,")")}},[t("div",{staticClass:"map"},[e.currentLocation.items.length>0?t("div",{staticClass:"items"},e._l(e.currentLocation.items,(function(o,a){return t("div",{key:o.id+"-"+a,staticClass:"item",on:{mouseenter:function(t){return e.showTooltip(a)},mouseleave:e.hideTooltip}},[t("img",{attrs:{src:o.imageId,alt:o.name}}),t("p",[e._v(e._s(o.name))]),e.tooltipIndex!==a||e.takingItem?e._e():t("div",{staticClass:"tooltip"},[t("p",[e._v("åç§°: "+e._s(o.name))]),t("p",[e._v("æè¿°: "+e._s(o.description))]),t("p",[e._v("é‡é‡: "+e._s(o.weight))]),t("p",[e._v("ç‰©å“ç±»å‹ï¼š "+e._s(1===o.isMagic?"é­”æ³•ç‰©å“":2===o.isMagic?"æ°¸ä¹…ç‰©å“":"ä¸€æ¬¡æ€§ç‰©å“")+" ")]),t("button",{on:{click:function(t){return t.stopPropagation(),e.takeItem(a)}}},[e._v("æ‹¿å–")])])])})),0):t("div",[t("p",[e._v("å½“å‰ä½ç½®æ²¡æœ‰å¯è·å–çš„ç‰©å“ã€‚")])])])])}),r=[],l=(o(62062),o(54554),o(2892),o(25782));const m=o.p+"img/map.008bfdcd.jpg",d=o.p+"img/banana.abea13cd.jpg",g=o.p+"img/cookie.5ed19c8b.jpg",u=o.p+"img/meat.7427ac24.jpg",f=o.p+"img/shit.40edacfa.png",p=o.p+"img/zooGate.4ecdaf6f.jpg",h=o.p+"img/monkeyZone.e09491d6.jpg",b=o.p+"img/lionZone.9a82d940.jpg",v=o.p+"img/elephantZone.5d8c6aab.jpg",I=o.p+"img/panadaZone.e34fe7c1.jpg",y=o.p+"img/export.a87df8f1.jpg",k={props:{currentRoomId:{type:Number,required:!0}},data:function(){return{locationMap:{1:{name:"å…¥å£",backgroundImage:p,items:[]},2:{name:"çŒ´å­å›­åŒº",backgroundImage:h,items:[]},3:{name:"ç‹®å­å›­åŒº",backgroundImage:b,items:[]},4:{name:"å¤§è±¡å›­åŒº",backgroundImage:v,items:[]},5:{name:"ç†ŠçŒ«å›­åŒº",backgroundImage:I,items:[]},6:{name:"å‡ºå£",backgroundImage:y,items:[]}},itemMap:{1:{id:1,name:"åœ°å›¾",imageId:m,color:"#ffcc99",borderColor:"#cc9966"},2:{id:2,name:"é¦™è•‰",imageId:d,color:"#ffcc99",borderColor:"#cc9966"},3:{id:3,name:"é­”æ³•é¥¼å¹²",imageId:g,color:"#ffcc99",borderColor:"#cc9966"},4:{id:4,name:"ç”Ÿè‚‰",imageId:u,color:"#ffcc99",borderColor:"#cc9966"},5:{id:5,name:"å¤§ä¾¿",imageId:f,color:"#ffcc99",borderColor:"#cc9966"}},tooltipIndex:null,takingItem:!1}},computed:{currentLocation:function(){return this.locationMap[this.currentRoomId]||this.locationMap[1]}},watch:{currentRoomId:{handler:function(e){this.updateLocation(e)},immediate:!0}},created:function(){this.listenDropItem(),this.listenUpdateItem()},methods:{listenDropItem:function(){var e=this;this.$root.$on("drop-item",(function(){e.updateLocation(e.currentRoomId)}))},listenUpdateItem:function(){var e=this;this.$root.$on("update-item",(function(){e.updateLocation(e.currentRoomId)}))},updateLocation:function(e){var t=this,o=localStorage.getItem("token");l.A.post("http://10.78.250.34:8081/room/check",{roomID:e},{headers:{token:o}}).then((function(o){var a=o.data;if(200===a.code&&a.data){var n=a.data.map((function(e){return{id:e.itemID,name:e.itemName,description:e.description,isMagic:e.isMagic,weight:e.weight,imageId:t.itemMap[e.itemID].imageId}}));t.$set(t.locationMap[e],"items",n)}else console.error("è·å–ç‰©å“åˆ—è¡¨å¤±è´¥:",a.message)}))["catch"]((function(e){console.error("è·å–ç‰©å“åˆ—è¡¨å‡ºé”™:",e)}))},showTooltip:function(e){this.tooltipIndex=e},hideTooltip:function(){this.tooltipIndex=null},takeItem:function(e){var t=this,o=this.currentLocation.items[e],a=localStorage.getItem("token"),n=localStorage.getItem("playerName");l.A.post("http://10.78.250.34:8081/item/take",{itemID:o.id,playerName:n},{headers:{token:a}}).then((function(a){var n=a.data;200===n.code?(localStorage.setItem("message","ä½ æˆåŠŸæ‹¿å–".concat(o.name)),t.currentLocation.items.splice(e,1),t.$root.$emit("take-item")):(localStorage.setItem("message","æ‹¿å–ç‰©å“å¤±è´¥,ä½ çš„è´Ÿé‡å‰©ä½™é‡ä¸è¶³"),t.$root.$emit("take-item"),console.error("æ‹¿å–ç‰©å“å¤±è´¥,ä½ çš„è´Ÿé‡å‰©ä½™é‡ä¸è¶³:",n.message))}))["catch"]((function(e){console.error("æ‹¿å–ç‰©å“å‡ºé”™:",e)}))}}},N=k;var x=o(81656),C=(0,x.A)(N,c,r,!1,null,"61a72a34",null);const _=C.exports;var w=function(){var e=this,t=e._self._c;return t("div",{staticClass:"sidebar"},[t("p",[e._v("å½“å‰è´Ÿé‡: "+e._s(e.usedWeight)+"/"+e._s(e.totalWeight))]),t("div",{staticClass:"inventory"},[e._l(e.displayedInventory,(function(o,a){return t("div",{key:o.itemID+"-"+a,staticClass:"item",style:{backgroundColor:o.color,border:"1px solid "+o.borderColor},on:{mouseenter:function(t){return e.showTooltip(a)},mouseleave:e.hideTooltip,click:function(t){return t.stopPropagation(),e.toggleDropConfirmation(a)}}},[t("img",{attrs:{src:o.imageId,alt:o.name}}),e.tooltipIndex!==a||e.confirmingDrop?e._e():t("div",{staticClass:"tooltip"},[t("p",[e._v("åç§°: "+e._s(o.itemName))]),t("p",[e._v("æè¿°: "+e._s(o.description))]),t("p",[e._v("é‡é‡: "+e._s(o.weight))]),t("p",[e._v("ç±»å‹ï¼š "+e._s(1===o.isMagic?"é­”æ³•ç‰©å“":2===o.isMagic?"æ°¸ä¹…ç‰©å“":"ä¸€æ¬¡æ€§ç‰©å“")+" ")]),t("button",{on:{click:function(t){return t.stopPropagation(),e.dropItem(a)}}},[e._v("æ”¾ä¸‹")]),t("button",{on:{click:function(t){return t.stopPropagation(),e.useItem(a)}}},[e._v("ä½¿ç”¨")]),t("button",{on:{click:function(t){return t.stopPropagation(),e.feedItem(a)}}},[e._v("æŠ•å–‚")])])])})),e._l(e.emptySlots,(function(e){return t("div",{key:"empty-"+e,staticClass:"item empty"})}))],2),t("MapLayer",{attrs:{visible:e.isMapLayerVisible},on:{close:function(t){e.isMapLayerVisible=!1}}})],1)},D=[],T=o(40668),M=(o(72712),o(34782),o(26099),function(){var e=this,t=e._self._c;return e.visible?t("div",{staticClass:"map-layer"},[t("button",{on:{click:e.closeMapLayer}},[e._v("å…³é—­")]),t("img",{attrs:{src:o(1061),alt:"åœ°å›¾"}})]):e._e()}),S=[];const A={props:{visible:{type:Boolean,required:!0}},methods:{closeMapLayer:function(){this.$emit("close")}}},$=A;var P=(0,x.A)($,M,S,!1,null,"6ec8ea99",null);const j=P.exports,L={name:"AppSidebar",components:{MapLayer:j},data:function(){return{totalWeight:100,usedWeight:0,inventory:[],items:{åœ°å›¾:{itemName:"åœ°å›¾",imageId:m,color:"#ffcc99",borderColor:"#cc9966"},é¦™è•‰:{itemName:"é¦™è•‰",imageId:d,color:"#ffcc99",borderColor:"#cc9966"},é­”æ³•é¥¼å¹²:{itemName:"é­”æ³•é¥¼å¹²",imageId:g,color:"#ffcc99",borderColor:"#cc9966"},ç”Ÿè‚‰:{itemName:"ç”Ÿè‚‰",imageId:u,color:"#ffcc99",borderColor:"#cc9966"},å¤§ä¾¿:{itemName:"å¤§ä¾¿",imageId:f,color:"#ffcc99",borderColor:"#cc9966"}},maxDisplayItems:9,tooltipIndex:null,confirmingDrop:!1,itemToDropIndex:null,isMapLayerVisible:!1}},computed:{displayedInventory:function(){var e=this;return this.inventory.slice(0,this.maxDisplayItems).map((function(t){return(0,T.A)((0,T.A)({},e.items[t.itemName]),t)}))},emptySlots:function(){return Math.max(0,this.maxDisplayItems-this.displayedInventory.length)}},created:function(){this.listenTakeItem(),this.listenUpdateItem()},methods:{listenTakeItem:function(){var e=this;this.$root.$on("take-item",(function(){e.fetchPlayerInfo(),e.fetchInventoryItems()}))},listenUpdateItem:function(){var e=this;this.$root.$on("update-item",(function(){e.fetchPlayerInfo(),e.fetchInventoryItems()}))},showTooltip:function(e){this.tooltipIndex=e},hideTooltip:function(){this.tooltipIndex=null},toggleDropConfirmation:function(e){this.confirmingDrop=!this.confirmingDrop,this.itemToDropIndex=e},dropItem:function(e){var t=this,o=this.inventory[e],a=localStorage.getItem("token"),n=localStorage.getItem("playerName");l.A.post("http://10.78.250.34:8081/item/drop",{itemID:o.itemID,playerName:n},{headers:{token:a}}).then((function(e){200===e.data.code?(localStorage.setItem("message","æˆåŠŸæ”¾ä¸‹ç‰©å“ï¼š".concat(o.itemName)),t.fetchPlayerInfo(),t.fetchInventoryItems(),t.$root.$emit("drop-item")):console.error("æ”¾ä¸‹ç‰©å“å¤±è´¥:",e.data.message)}))["catch"]((function(e){console.error("æ”¾ä¸‹ç‰©å“å‡ºé”™:",e)}))["finally"]((function(){t.confirmingDrop=!1,t.itemToDropIndex=null}))},useItem:function(e){var t=this,o=this.inventory[e];if("åœ°å›¾"===o.itemName)this.isMapLayerVisible=!0;else{var a=localStorage.getItem("token"),n=localStorage.getItem("playerName");l.A.post("http://10.78.250.34:8081/item/use",{itemID:o.itemID,playerName:n},{headers:{token:a}}).then((function(e){200===e.data.code?(t.fetchPlayerInfo(),t.fetchInventoryItems(),localStorage.setItem("message",e.data.message),t.$root.$emit("use-item")):console.error("ä½¿ç”¨ç‰©å“å¤±è´¥:",e.data.message)}))["catch"]((function(e){console.error("ä½¿ç”¨ç‰©å“å‡ºé”™:",e)}))}},feedItem:function(e){var t=this,o=this.inventory[e],a=localStorage.getItem("token"),n=localStorage.getItem("playerName");l.A.post("http://10.78.250.34:8081/item/feed",{itemID:o.itemID,playerName:n},{headers:{token:a}}).then((function(e){var o=e.data;200===o.code?(t.fetchPlayerInfo(),t.fetchInventoryItems(),localStorage.setItem("message",o.message),t.$root.$emit("feed-item")):console.error("æŠ•å–‚ç‰©å“å¤±è´¥:",o.message)}))["catch"]((function(e){console.error("æŠ•å–‚ç‰©å“å‡ºé”™:",e)}))},fetchPlayerInfo:function(){var e=this,t=localStorage.getItem("token"),o=localStorage.getItem("playerName");l.A.post("http://10.78.250.34:8081/player/getPlayerInfo",{playerName:o},{headers:{token:t}}).then((function(t){if(200===t.data.code){var o=t.data.data;e.usedWeight=o.currentWeight,e.totalWeight=o.maxCarryWeight}else console.error("è·å–ç©å®¶ä¿¡æ¯å¤±è´¥:",t.data.message)}))["catch"]((function(e){console.error("è·å–ç©å®¶ä¿¡æ¯å‡ºé”™:",e)}))},fetchInventoryItems:function(){var e=this,t=localStorage.getItem("token"),o=localStorage.getItem("playerName");l.A.post("http://10.78.250.34:8081/item/getItems",{playerName:o},{headers:{token:t}}).then((function(t){200===t.data.code?(e.inventory=t.data.data,e.usedWeight=e.inventory.reduce((function(e,t){return e+t.weight}),0)):console.error("è·å–èƒŒåŒ…ç‰©å“å¤±è´¥:",t.data.message)}))["catch"]((function(e){console.error("è·å–èƒŒåŒ…ç‰©å“å‡ºé”™:",e)}))},selectItem:function(e){console.log("é€‰ä¸­äº†ç‰©å“ï¼š",this.inventory[e])}},mounted:function(){this.fetchPlayerInfo(),this.fetchInventoryItems()}},U=L;var R=(0,x.A)(U,w,D,!1,null,"1d1af044",null);const E=R.exports;o(25276);var W=function(){var e=this,t=e._self._c;return t("div",[t("el-button",{staticClass:"font",on:{click:e.openChat}},[e._v("æ‰“å¼€èŠå¤©")]),t("el-dialog",{attrs:{visible:e.dialogVisible,title:"èŠå¤©å®¤",width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticClass:"chat-container"},[t("div",{staticClass:"chat-header"},[t("p",[e._v("å½“å‰åœ¨çº¿äººæ•°: "+e._s(e.onlineUsers))])]),t("div",{staticClass:"chat-content"},e._l(e.messages,(function(o){return t("div",{key:o.id,staticClass:"chat-message"},[t("span",[t("strong",[e._v(e._s(o.user)+":")]),e._v(" "+e._s(o.text))])])})),0),t("div",{staticClass:"chat-footer"},[t("el-button",{staticClass:"emoji",on:{click:e.openEmojiPicker}},[e._v("ğŸ˜€")]),t("el-input",{attrs:{placeholder:"è¾“å…¥æ¶ˆæ¯..."},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendMessage.apply(null,arguments)}},model:{value:e.newMessage,callback:function(t){e.newMessage=t},expression:"newMessage"}}),t("el-button",{on:{click:e.sendMessage}},[e._v("å‘é€")])],1)])]),t("el-dialog",{attrs:{visible:e.emojiDialogVisible,title:"é€‰æ‹©è¡¨æƒ…",width:"70%"},on:{"update:visible":function(t){e.emojiDialogVisible=t}}},[t("div",{staticClass:"emoji-container"},e._l(e.emojiArr,(function(o){return t("span",{key:o.className,on:{click:function(t){return e.selectEmoji(o.icon)}}},[e._v(" "+e._s(o.icon)+" ")])})),0)])],1)},V=[],Z=(o(60739),o(33110),o(79432),o(42762),[{className:"bg-1f604",icon:"ğŸ˜„"},{className:"bg-1f603",icon:"ğŸ˜ƒ"},{className:"bg-1f600",icon:"ğŸ˜€"},{className:"bg-1f60a",icon:"ğŸ˜Š"},{className:"bg-1f609",icon:"ğŸ˜‰"},{className:"bg-1f60d",icon:"ğŸ˜"},{className:"bg-1f618",icon:"ğŸ˜˜"},{className:"bg-1f61a",icon:"ğŸ˜š"},{className:"bg-1f617",icon:"ğŸ˜—"},{className:"bg-1f619",icon:"ğŸ˜™"},{className:"bg-1f61c",icon:"ğŸ˜œ"},{className:"bg-1f61d",icon:"ğŸ˜"},{className:"bg-1f61b",icon:"ğŸ˜›"},{className:"bg-1f633",icon:"ğŸ˜³"},{className:"bg-1f601",icon:"ğŸ˜"},{className:"bg-1f614",icon:"ğŸ˜”"},{className:"bg-1f60c",icon:"ğŸ˜Œ"},{className:"bg-1f612",icon:"ğŸ˜’"},{className:"bg-1f61e",icon:"ğŸ˜"},{className:"bg-1f623",icon:"ğŸ˜£"},{className:"bg-1f622",icon:"ğŸ˜¢"},{className:"bg-1f602",icon:"ğŸ˜‚"},{className:"bg-1f62d",icon:"ğŸ˜­"},{className:"bg-1f62a",icon:"ğŸ˜ª"},{className:"bg-1f625",icon:"ğŸ˜¥"},{className:"bg-1f630",icon:"ğŸ˜°"},{className:"bg-1f605",icon:"ğŸ˜…"},{className:"bg-1f613",icon:"ğŸ˜“"},{className:"bg-1f629",icon:"ğŸ˜©"},{className:"bg-1f62b",icon:"ğŸ˜«"},{className:"bg-1f628",icon:"ğŸ˜¨"},{className:"bg-1f631",icon:"ğŸ˜±"},{className:"bg-1f620",icon:"ğŸ˜ "},{className:"bg-1f621",icon:"ğŸ˜¡"},{className:"bg-1f624",icon:"ğŸ˜¤"},{className:"bg-1f616",icon:"ğŸ˜–"},{className:"bg-1f606",icon:"ğŸ˜†"},{className:"bg-1f60b",icon:"ğŸ˜‹"},{className:"bg-1f637",icon:"ğŸ˜·"},{className:"bg-1f60e",icon:"ğŸ˜"},{className:"bg-1f634",icon:"ğŸ˜´"},{className:"bg-1f635",icon:"ğŸ˜µ"},{className:"bg-1f632",icon:"ğŸ˜²"},{className:"bg-1f61f",icon:"ğŸ˜Ÿ"},{className:"bg-1f626",icon:"ğŸ˜¦"},{className:"bg-1f627",icon:"ğŸ˜§"},{className:"bg-1f608",icon:"ğŸ˜ˆ"},{className:"bg-1f47f",icon:"ğŸ‘¿"},{className:"bg-1f62e",icon:"ğŸ˜®"},{className:"bg-1f62c",icon:"ğŸ˜¬"},{className:"bg-1f610",icon:"ğŸ˜"},{className:"bg-1f615",icon:"ğŸ˜•"},{className:"bg-1f62f",icon:"ğŸ˜¯"},{className:"bg-1f636",icon:"ğŸ˜¶"},{className:"bg-1f607",icon:"ğŸ˜‡"},{className:"bg-1f60f",icon:"ğŸ˜"},{className:"bg-1f611",icon:"ğŸ˜‘"},{className:"bg-1f63a",icon:"ğŸ˜º"},{className:"bg-1f638",icon:"ğŸ˜¸"},{className:"bg-1f63b",icon:"ğŸ˜»"},{className:"bg-1f63d",icon:"ğŸ˜½"},{className:"bg-1f63c",icon:"ğŸ˜¼"},{className:"bg-1f640",icon:"ğŸ™€"},{className:"bg-1f63f",icon:"ğŸ˜¿"},{className:"bg-1f639",icon:"ğŸ˜¹"},{className:"bg-1f63e",icon:"ğŸ˜¾"},{className:"bg-1f479",icon:"ğŸ‘¹"},{className:"bg-1f47a",icon:"ğŸ‘º"}]);const O={data:function(){return{dialogVisible:!1,emojiDialogVisible:!1,onlineUsers:"0",messages:[],newMessage:"",emojiArr:Z,ws:null}},created:function(){this.connectToWebSocket()},methods:{openChat:function(){this.dialogVisible=!0},openEmojiPicker:function(){this.emojiDialogVisible=!0},selectEmoji:function(e){this.newMessage+=e},connectToWebSocket:function(){var e=this;this.ws=new WebSocket("ws://10.78.250.34:8081/webSocket/"+localStorage.getItem("playerName")),this.ws.onopen=function(){console.log("WebSocket connected")},this.ws.onmessage=function(t){try{var o=JSON.parse(t.data);switch(o.type){case"update":e.$root.$emit("update-item");break;case"message":e.messages.push(o);break;case"onlineUsers":e.onlineUsers=o.text;break;default:console.log("Unknown message type:",o)}}catch(a){console.error("Error parsing JSON:",a)}},this.ws.onclose=function(){console.log("WebSocket closed"),e.onlineUsers="0"},this.ws.onerror=function(e){console.log("WebSocket error:",e)}},sendMessage:function(){""!==this.newMessage.trim()&&(this.sendMessageToServer({type:"message",text:this.newMessage,user:this.getPlayerName()}),this.newMessage="")},sendMessageToServer:function(e){this.ws.send(JSON.stringify(e))},getPlayerName:function(){return localStorage.getItem("playerName")||"æœªçŸ¥ç”¨æˆ·"}},beforeDestroy:function(){this.ws&&this.ws.close()}},J=O;var q=(0,x.A)(J,W,V,!1,null,"f4de27ca",null);const z=q.exports,F={name:"home-main",components:{MainContent:_,AppSidebar:E,MainChat:z},data:function(){return{playerInfo:null,currentRoomId:1,dialogContent:"æ¬¢è¿è¿›å…¥ã€Šå‹‡é—¯åŠ¨ç‰©å›­ã€‹!".concat(this.getPlayerName()),displayedText:"",displayTimeout:null,locationMap:{1:"å…¥å£",2:"çŒ´å­å›­åŒº",3:"ç‹®å­å›­åŒº",4:"å¤§è±¡å›­åŒº",5:"ç†ŠçŒ«å›­åŒº",6:"å‡ºå£"},visitedDirection:[],backDirection:"",showExitDialog:!1}},created:function(){this.displayedText="",this.startTextAnimation(),this.fetchUserInfo(),this.listenFeedItem(),this.listenUseItem(),this.listenTakeItem(),this.listenDropItem()},methods:{listenFeedItem:function(){var e=this;this.$root.$on("feed-item",(function(){e.dialogContent=e.getPlayMessage(),e.displayedText="",e.startTextAnimation(),e.fetchUserInfo()}))},listenUseItem:function(){var e=this;this.$root.$on("use-item",(function(){e.dialogContent=e.getPlayMessage(),e.displayedText="",e.startTextAnimation()}))},listenTakeItem:function(){var e=this;this.$root.$on("take-item",(function(){e.dialogContent=e.getPlayMessage(),e.displayedText="",e.startTextAnimation(),e.fetchUserInfo()}))},listenDropItem:function(){var e=this;this.$root.$on("drop-item",(function(){e.dialogContent=e.getPlayMessage(),e.displayedText="",e.startTextAnimation(),e.fetchUserInfo()}))},getPlayerName:function(){return localStorage.getItem("playerName")},getPlayToken:function(){return localStorage.getItem("token")},getPlayMessage:function(){return localStorage.getItem("message")},fetchUserInfo:function(){var e=this;return(0,s.A)((0,i.A)().mark((function t(){var o,a,n;return(0,i.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(o=e.getPlayerName(),a=e.getPlayToken(),o&&a){t.next=5;break}return console.error("æœ¬åœ°å­˜å‚¨ä¸­æ²¡æœ‰æ‰¾åˆ° playerName æˆ– token"),t.abrupt("return");case 5:return t.prev=5,t.next=8,l.A.post("http://10.78.250.34:8081/player/getPlayerInfo",{playerName:o},{headers:{token:a}});case 8:n=t.sent,200===n.data.code?(e.playerInfo=n.data.data,e.currentRoomId=e.playerInfo.currentRoomID):console.error("è·å–ç”¨æˆ·ä¿¡æ¯å‡ºé”™:",n.data.message),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](5),console.error("è¯·æ±‚å‡ºé”™:",t.t0);case 15:case"end":return t.stop()}}),t,null,[[5,12]])})))()},move:function(e){var t=this;return(0,s.A)((0,i.A)().mark((function o(){var a,n,s,c,r,m,d,g,u,f;return(0,i.A)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(t.displayTimeout&&(clearTimeout(t.displayTimeout),t.displayTimeout=null,t.displayedText=t.dialogContent),a=t.getPlayerName(),n=t.getPlayToken(),s={east:0,south:1,west:2,north:3,stay:4,back:5},c={west:"east",north:"south",east:"west",south:"north"},r={1:"å…¥å£",2:"çŒ´å­å›­åŒº",3:"ç‹®å­å›­åŒº",4:"å¤§è±¡å›­åŒº",5:"ç†ŠçŒ«å›­åŒº",6:"å‡ºå£"},a&&n){o.next=9;break}return console.error("æœ¬åœ°å­˜å‚¨ä¸­æ²¡æœ‰æ‰¾åˆ° playerName æˆ– token"),o.abrupt("return");case 9:if(o.prev=9,"back"!==e){o.next=23;break}if(!(t.visitedDirection.length>0)){o.next=20;break}return m=t.visitedDirection.pop(),t.backDirection=c[m],o.next=16,l.A.post("http://10.78.250.34:8081/room/go",{playerName:a,direction:s[t.backDirection]},{headers:{token:n}});case 16:d=o.sent,200===d.data.code?(g=d.data.data,t.currentRoomId=g.roomID,t.dialogContent="ä½ å›åˆ°äº†".concat(g.roomName,"ã€‚ ").concat(g.description)):t.dialogContent="æ— æ³•å¾€".concat(t.getDirectionText(e),"èµ°ï¼Œä½ ç°åœ¨åœ¨").concat(r[t.currentRoomId],"ã€‚"),o.next=21;break;case 20:t.dialogContent="æ— æ³•è¿”å›,ä½ å·²ç»åˆ°äº†æœ€åˆçš„åœ°æ–¹ã€‚";case 21:o.next=27;break;case 23:return o.next=25,l.A.post("http://10.78.250.34:8081/room/go",{playerName:a,direction:s[e]},{headers:{token:n}});case 25:u=o.sent,200===u.data.code?(f=u.data.data,t.visitedDirection.push(e),t.currentRoomId=f.roomID,t.dialogContent="å¾€".concat(t.getDirectionText(e),"èµ°ï¼Œä½ æ¥åˆ°äº†").concat(f.roomName,"ã€‚ ").concat(f.description)):4===s[e]?t.dialogContent="ä½ åœç•™åœ¨åŸåœ°ï¼Œä½ ç°åœ¨åœ¨".concat(r[t.currentRoomId],"ã€‚"):t.dialogContent="æ— æ³•å¾€".concat(t.getDirectionText(e),"èµ°ï¼Œä½ ç°åœ¨åœ¨").concat(r[t.currentRoomId],"ã€‚");case 27:o.next=32;break;case 29:o.prev=29,o.t0=o["catch"](9),console.error("è¯·æ±‚å‡ºé”™:",o.t0);case 32:t.displayedText="",t.startTextAnimation();case 34:case"end":return o.stop()}}),o,null,[[9,29]])})))()},startTextAnimation:function(){var e=this,t=0,o=function o(){t<e.dialogContent.length?(e.displayedText+=e.dialogContent[t++],e.displayTimeout=setTimeout(o,50)):e.displayTimeout=null};o()},getDirectionText:function(e){var t={east:"ä¸œ",south:"å—",west:"è¥¿",north:"åŒ—"};return t[e]},exitGame:function(){this.showExitDialog=!0},confirmExit:function(){localStorage.removeItem("playerName"),localStorage.removeItem("token"),this.$router.push("/login-main")}},beforeDestroy:function(){this.displayTimeout&&(clearTimeout(this.displayTimeout),this.displayTimeout=null)}},G=F;var B=(0,x.A)(G,a,n,!1,null,"86cd2164",null);const H=B.exports},26263:(e,t,o)=>{e.exports=o.p+"img/Zoo.9f838bc7.png"},81810:(e,t,o)=>{e.exports=o.p+"img/npc.b6cbf61e.jpg"},1061:(e,t,o)=>{e.exports=o.p+"img/zooMap.e4268453.jpg"}}]);
//# sourceMappingURL=873.7942c0f6.js.map